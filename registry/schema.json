{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "KAMI Registry Index",
  "description": "Schema for the community tool registry index.json",
  "type": "array",
  "items": {
    "type": "object",
    "required": ["id", "name", "version", "description", "source", "wasm_sha256"],
    "properties": {
      "id": {
        "type": "string",
        "pattern": "^[a-z][a-z0-9]*\\.[a-z][a-z0-9]*(\\.[a-z][a-z0-9-]*)+$",
        "description": "Reverse-DNS tool identifier"
      },
      "name": {
        "type": "string",
        "minLength": 1,
        "maxLength": 64,
        "description": "Human-readable tool name"
      },
      "version": {
        "type": "string",
        "pattern": "^[0-9]+\\.[0-9]+\\.[0-9]+",
        "description": "Semantic version"
      },
      "description": {
        "type": "string",
        "minLength": 1,
        "maxLength": 120,
        "description": "Short description shown in search results"
      },
      "source": {
        "type": "string",
        "pattern": "^[a-zA-Z0-9._-]+/[a-zA-Z0-9._-]+(@[a-zA-Z0-9._-]+)?$",
        "description": "GitHub shorthand: owner/repo or owner/repo@tag"
      },
      "wasm_sha256": {
        "type": "string",
        "minLength": 64,
        "maxLength": 64,
        "pattern": "^[a-f0-9]{64}$",
        "description": "SHA-256 hex digest of the .wasm file"
      },
      "signature": {
        "type": "string",
        "minLength": 128,
        "maxLength": 128,
        "pattern": "^[a-f0-9]{128}$",
        "description": "Ed25519 hex signature of the .wasm file (optional)"
      },
      "signer_public_key": {
        "type": "string",
        "minLength": 64,
        "maxLength": 64,
        "pattern": "^[a-f0-9]{64}$",
        "description": "Ed25519 hex public key of the signer (optional)"
      }
    },
    "additionalProperties": false
  }
}
